<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SeniorFit - Avaliação e Treinamento</title>
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#111827" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: {
                50: '#f0f9ff',
                100: '#e0f2fe',
                500: '#0ea5e9',
                600: '#0284c7',
                700: '#0369a1',
                900: '#0c4a6e',
              }
            },
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
            },
          },
        },
      }
    </script>
    <script>
      // --- SUPER ROBUST BROWSER POLYFILLS ---
      // This prevents the "White Screen" or "Stuck Loading" caused by Node.js libraries
      
      window.global = window;
      
      // 1. Process Polyfill
      window.process = {
        env: { NODE_ENV: 'development' },
        version: '',
        versions: {},
        nextTick: function(cb) { setTimeout(cb, 0); },
        platform: 'browser'
      };

      // 2. Buffer Polyfill (Minimal implementation to satisfy imports)
      window.Buffer = {
        isBuffer: function() { return false; },
        from: function(data) { return new Uint8Array(data); },
        alloc: function(size) { return new Uint8Array(size); }
      };

      // 3. Crypto Polyfill
      if (!window.crypto) {
        window.crypto = {} as any;
      }
      if (!window.crypto.randomUUID) {
        window.crypto.randomUUID = function() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
              var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
              return v.toString(16);
            });
        };
      }

      // 4. Global Error Handler for Startup
      window.addEventListener('error', function(e) {
        console.error("Global Error:", e);
        const root = document.getElementById('root');
        // Only show error screen if app hasn't loaded (still showing spinner)
        const isStillLoading = root && root.innerHTML.includes('Carregando SeniorFit');
        
        if (isStillLoading) {
           document.body.innerHTML = `
            <div style="padding: 24px; font-family: sans-serif; background: #fef2f2; color: #991b1b; height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center;">
              <h1 style="font-size: 24px; margin-bottom: 10px; font-weight: bold;">Erro de Inicialização</h1>
              <p style="max-width: 500px; margin-bottom: 20px;">O navegador encontrou um problema técnico ao carregar os módulos.</p>
              <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #fca5a5; margin-bottom: 20px; text-align: left; overflow: auto; max-width: 90%;">
                <strong>Erro:</strong> ${e.message}
              </div>
              <button onclick="window.location.reload()" style="padding: 12px 24px; background-color: #dc2626; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">Tentar Novamente</button>
            </div>
          `;
        }
      });
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
      body { font-family: 'Inter', sans-serif; }
      @media print {
        body * { visibility: hidden; }
        #printable-section, #printable-section * { visibility: visible; }
        #printable-section { position: absolute; left: 0; top: 0; width: 100%; background-color: white; padding: 0; margin: 0; }
        .no-print { display: none !important; }
        * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
        @page { margin: 1cm; size: A4; }
      }
      .chat-scroll::-webkit-scrollbar { width: 6px; }
      .chat-scroll::-webkit-scrollbar-track { background: #f1f1f1; }
      .chat-scroll::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 3px; }
    </style>
  <script type="importmap">
{
  "imports": {
    "vite": "https://esm.sh/vite@^7.3.1",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "@vitejs/plugin-react": "https://esm.sh/@vitejs/plugin-react@^5.1.2",
    "react/": "https://esm.sh/react@^19.2.3/",
    "react": "https://esm.sh/react@^19.2.3",
    "@google/generative-ai": "https://esm.sh/@google/generative-ai@^0.21.0",
    "lucide-react": "https://esm.sh/lucide-react@^0.562.0",
    "@emailjs/browser": "https://esm.sh/@emailjs/browser@^4.4.1",
    "@google/genai": "https://esm.sh/@google/genai@^1.37.0",
    "recharts": "https://esm.sh/recharts@^3.6.0"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
  <body class="bg-gray-50 text-gray-900 antialiased">
    <div id="root">
       <!-- Loading State -->
       <div style="height: 100vh; display: flex; flex-col align-items: center; justify-content: center; background-color: #f9fafb;">
          <div style="text-align: center;">
             <div style="width: 50px; height: 50px; border: 4px solid #e5e7eb; border-top-color: #0284c7; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px;"></div>
             <p style="font-family: sans-serif; color: #374151; font-weight: 500;">Carregando SeniorFit...</p>
          </div>
       </div>
       <style>@keyframes spin { to { transform: rotate(360deg); } }</style>
    </div>
    <script type="module" src="/index.tsx"></script>
  </body>
</html>